2007-09-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py (Handler.handle): Pass application to
	`Document.build'.

	* lib/wiking/util.py (Document.build): Supply application defined
	language variants if no language variants are defined for the
	document or its menu item.

	* translations/Makefile: Minor improvement.

2007-09-25  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Use `prefer_display' where necessary.

	* lib/wiking/db.py: Cosmetic improvements.

	* Makefile: Check python path before installation.

2007-09-24  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Allow repeated cvs-install.  Make translations for
	cvs-install.

	* lib/wiking/configuration.py
	(Configuration._Option_config_file.default): Prevent using .pyo file.

	* resources/css/default.css: Minor fieldset display improvement.

	* lib/wiking/modules.py (CookieAuthentication._auth_log): Renamed
	to `_auth_hook'.

	* lib/wiking/db.py (RssModule._rss_info): New method.
	(PytisModule.action_list): Use it.

2007-09-20  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/__init__.py: Minor import problem fixed.

	* lib/wiking/application.py: Use `req.done()' instead of `req.OK'.

	* lib/wiking/request.py: Unwanted dependency on apache fixed.

2007-09-19  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/db.py: Give higher precedence to resolution by key
	than by referer.  Improved support for inserting related records.

	* lib/wiking/util.py: Ignore menu item `variants' if they were not
	defined.

	* lib/wiking/modules.py (CookieAuthentication): Added support for
	loogging login attempts.

	* lib/wiking/cms.py: Give higher precedence to resolution by key
	than by referer.  Fixed problems with page and attachment
	relation.

2007-09-18  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/application.py (Application.handle_exception): Ignore
	IOError when client closes the connection.  Improved bugreport
	information.

2007-09-17  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/cms/cms.en.txt: `Mapping' -> `Menu'

	* doc/src/cms/Titles.en.txt: File removed.

	* doc/src/cms/Titles.cs.txt: File removed.

	* doc/src/cms/Mapping.en.txt: File removed.

	* doc/src/cms/Mapping.cs.txt: File removed.

	* lib/wiking/cms.py: New module `Menu' for improved main menu
	management, replacing the `Mapping' module in WMI.  The most
	important new features are independent publishing of menu items in
	different languages, menu item descriptions, and combined
	management of menu structure and menu titles.  Stylesheets now
	mapped statically.

	* lib/wiking/util.py: The support for languages and variants
	improved and documented to simplify its usage within the
	application.

	* lib/wiking/modules.py: Don't care about language and variants
	where not necessary.

	* lib/wiking/handler.py: Authentication error handling
	simplified.  Pass the request to `Document.build()'.

	* lib/wiking/db.py: Language and variants handling simplified.

	* sql/wiking.sql: New menu management support implemented.
	
	* sql/init.sql: Updated.
	
	* resources/css/default.css: Updated.
	
2007-09-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Added support for correct link name
	substitution in WMI page preview.  Display page management
	controls outside WMI.

	* lib/wiking/db.py: Allow resolution by key to support forms
	outside WMI.  Improved actin menu display outside WMI.

	* lib/wiking/util.py (ActionMenu): Added support for alternative
	appearance outside WMI.

	* resources/css/default.css: Updated.
	
2007-09-11  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/db.py: WMI dependant code reduced.

	* lib/wiking/cms.py: Resolve records by referer even in WMI.

	* lib/wiking/util.py (make_uri): Minor improvement.

	* resources/css/default.css: Updated.
	
2007-09-10  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/db.py (PytisModule._action_args): WMI resolution
	moved to `CMSModule._resolve()'.  Use `pytis.web.ListView' instead
	of the previous implementation from `util' and define the layout
	by `_LIST_LAYOUT', not `_CUSTOM_VIEW'.  Always use the action
	`view' instead of combining `view' and `show'.

	* lib/wiking/util.py (ListView): Moved to `pytis.web'.  
	(ActionMenu): Add referer to uri explicitly.

	* lib/wiking/cms.py: `_auth_check()' -> `_auth_check_password()'.
	Allow page owner assignment.  Assign all privilegs to page owner.
	Always use the action `view' instead of combining `view' and
	`show'.  `_CUSTOM_VIEW' replaced by `_LIST_LAYOUT'.
	(Attachments): Link to page, not the mapping item in the table.
	Fixed attachment download filename within WMI.
	(CMSModule._resolve): Define the WMI specific resolution here.

	* lib/wiking/modules.py: `_auth_check()' ->
	`_auth_check_password()'.  Always use the action `view' instead of
	combining `view' and `show'.

	* sql/wiking.sql: Added `owner' column for each mapping item.

	* resources/css/default.css: Updated.
	
2007-09-07  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Updated.
	
	* doc/src/devel/application.py: Include method arguments.

	* lib/wiking/cms.py: Define the menu and panels just within the
	application.  Suppress parent item links in mapping table.

	* lib/wiking/handler.py: Always use the application to query for
	menu and panels.

	* lib/wiking/modules.py: Dropped support for per-module menu and
	panels definition.

	* lib/wiking/util.py: Added support for the `active' flag on
	nodes.  Dropped support for `inline' state.

	* lib/wiking/export.py: Always show documentation "inline".
	Validation improvements.  Minor improvements for textual browsers.

	* lib/wiking/db.py: Don't pass the `inline' parameter in
	documentation link.

	* lib/wiking/application.py: Allow easy stylesheet redefinition.

2007-09-06  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/application.py (Application.panels): Display password
	expiration date in the login panel if it was defined.

	* lib/wiking/request.py: Added support for password expiration
	date specification.

	* translations/wiking-cms.cs.po: Updated.

	* translations/wiking.cs.po: Updated.

2007-09-05  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (SubmenuRedirect): New class.

2007-09-04  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Authorization checking implemented within the
	new mechanism.

	* lib/wiking/export.py: Avoid invalid link to
	`_wmi/Documentation'.

	* lib/wiking/util.py: Custom view export bug fixed.

	* lib/wiking/api.py: All modules transformed into just one class
	`Application' and moved to `application.py'.

	* lib/wiking/application.py: New file.

	* lib/wiking/modules.py: Use just `Application' instead of former
	API modules.
	(RequestHandler, ActionHandler): Check authorization before
	handling the request.

	* lib/wiking/handler.py: Use just `Application' instead of former
	API modules.  

	* lib/wiking/db.py: Use just `Application' instead of former API
	modules.  Authorization support removed in favor of the new
	generalized implementation in base module classes.

	* lib/wiking/request.py (Request): Expect the current application
	as a constructor argument.

        * doc/src/devel/_index.txt: Updated.
	
        * doc/src/devel/api.py: Transformed into `application.py'.
	
        * doc/src/devel/application.py: New file.
	
        * doc/src/devel/devel.en.txt: Updated.
	
        * doc/src/devel/modularization.en.txt: Updated.
		
2007-09-03  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/__init__.py: Imports reordered.

	* lib/wiking/cms.py: Define CMS specific roles here.

	* lib/wiking/db.py: Authorization checking simplified.

	* lib/wiking/request.py: Define `User' and `Roles' here.

	* lib/wiking/util.py: `User' and `Roles' moved to `request'.

2007-08-31  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Fixed exception handling.

	* lib/wiking/__init__.py: Don't import `cgitb' here.

	* lib/wiking/api.py: Import `cgitb' here.

	* lib/wiking/modules.py: Fixed a bug in documentation path
	handling.

2007-08-29  Tomas Cerha  <cerha@brailcom.org>

	* sql/init.sql: Don't insert 'panels.css' in styles.

2007-08-28  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Minor fix.

	* sql/init.sql: Yellow color theme added.

	* lib/wiking/modules.py (RequestHandler._base_uri): New method.

	* lib/wiking/db.py: Do without 'Mapping.modtitle'.  Allow better message
	customization on insert, update and delete.
	(PytisModule._identifier): Method replaced by
	`RequestHandler._base_uri()'.

	* lib/wiking/cms.py: Menu creation optimized.  Use
	`self._base_uri()' instead of `self._identifier()'.  Installation
	fixed.  Use a different message when page is saved and published.

	* lib/wiking/api.py (Mapping.modtitle): Method removed.

2007-08-27  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (Module): Constructor argument 'resolver'
	removed.  Methods `panels' and amenu' moved to `RequestHandler'.

	* lib/wiking/handler.py: Added support for modularized exception
	handling.  Minor request processing optimizations.  Allow
	configuration options to be overriden in apache configuration
	file.

	* lib/wiking/api.py (ErrorHandler): New module.

	* lib/wiking/request.py (Request): API cleaned.

	* lib/wiking/install.py: File removed.

	* lib/wiking/db.py: Added support for title templates.
	(PytisModule): Process the `resolver' constructor arg in this
	class.

	* lib/wiking/cms.py: Use title templates.
	(ErrorHandler): New module.  CMS installation moved here.

	* lib/wiking/util.py: Delete action menu args fixed.

2007-08-24  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/util.py: Use the 'search' argument for the "list"
	action button.

	* lib/wiking/cms.py (Planner._condition): Accept the request argument. 

	* lib/wiking/db.py: Pass the request object to the module's
	`_condition()' method.
	(PytisModule.action_insert): Fixed a bug with uid access.

2007-08-23  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Prefer NotAcceptable error message to
	Forbidden if there is at least one language variant published.
	Allow 'Roles.AUTHOR' to enter WMI, but not publish changes in
	pages.

	* lib/wiking/request.py: Defive from pytis request API
	specifications and implement their interface.

	* lib/wiking/util.py (FileUpload): Class removed.
	(make_uri): Ignore arguments with None value.

	* Makefile: Pass -dP to cvs update.

	* lib/wiking/db.py: Respect changes in pytis forms.
	(PytisModule._prefill, PytisModule.action_list): Don't raise error
	when unable to determine prefered language.

2007-08-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/cms.py: Use `upload_limit' and allow its modification
	in WMI.

	* lib/wiking/configuration.py: New option `upload_limit'.

	* sql/wiking.sql: New field for `upload_limit'.

	* translations/wiking-cms.cs.po: Updated.

	* translations/wiking.cs.po: Updated.

	* lib/wiking/db.py: Omit binary values in form prefill.

	* resources/css/default.css: Minor improvement.

	* lib/wiking/request.py (WikingRequest.user): Avoid using
	try/except blocks.

	* lib/wiking/modules.py (CookieAuthentication): Allow request
	access in derived classes.

2007-08-21  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking-cms.cs.po: Updated.

	* sql/wiking.sql: Added page title column defaulting to page
	identifier.

	* lib/wiking/cms.py: Use page title as database column, not virtual.

2007-08-20  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/cms/Pages.cs.txt: Updated.

	* doc/src/cms/Pages.en.txt: Updated.

	* lib/wiking/cms.py: Simplified page publication control.

	* lib/wiking/db.py: Allow custom EditForm submit buttons per module.

	* lib/wiking/util.py (ActionMenu): Delete action hack fixed.

	* sql/wiking.sql: Respect `published' in page insert rule.

	* translations/wiking-cms.cs.po: Updated.

	* translations/wiking.cs.po: Updated.

2007-08-17  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/configuration.py: Configuration file lookup fixed to
	avoid using the `pyc' file.

	* lib/wiking/cms.py: Make use of new method for tree emulation in
	pytis forms.

	* lib/wiking/db.py: Respect changes in pytis form classes and
	support long list browsing and sorting.

	* resources/css/default.css: Form styles modified according to
	changes in form export.

	* lib/wiking/util.py: Default color theme improved. 
	(_CustomView._export_row_custom): Respect changes in parent class.
	(get_module): Use `wiking.cms' only if `wikingmodules' really
	don't exist, not if there is a problem loading them.

2007-08-15  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: New and updated styles for pytis
	forms.

	* lib/wiking/db.py: Don't pass rows to list forms directly, just
	pass the condition and let the form do the select.  Pass paging
	arguments to list forms.

	* lib/wiking/cms.py (Config.Spec): Respect changes in pytis
	`Configuration' interface.
	(Planner._condition): Respect the changed interface of this method
	in parent class.

	* lib/wiking/export.py: Export menu only if there are items.

	* lib/wiking/util.py (ListView._wrap_exported_rows_custom):
	Respect the change in parent class.

	* doc/src/user/navigation.cs.txt: Conflicting anchor names changed.

	* doc/src/user/navigation.en.txt: Conflicting anchor names changed.

	* doc/src/user/navigation.pl.txt: Conflicting anchor names changed.

2007-08-10  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (DocumentHandler._document): Hardcoded
	documentation subdirectories updated.

	* doc/src/devel/_index.txt: New file.
	
	* doc/src/devel/modularization.en.txt: New file.

	* lib/wiking/configuration.py: Docstrings improved.

	* doc/src/cms/Attachments.cs.txt: New file.

	* doc/src/cms/Attachments.en.txt: New file.

	* doc/src/cms/Languages.cs.txt: New file.

	* doc/src/cms/Languages.en.txt: New file.

	* doc/src/cms/Mapping.cs.txt: New file.

	* doc/src/cms/Mapping.en.txt: New file.

	* doc/src/cms/News.cs.txt: New file.

	* doc/src/cms/News.en.txt: New file.

	* doc/src/cms/Pages.cs.txt: New file.

	* doc/src/cms/Pages.en.txt: New file.

	* doc/src/cms/Panels.cs.txt: New file.

	* doc/src/cms/Panels.en.txt: New file.

	* doc/src/cms/Planner.cs.txt: New file.

	* doc/src/cms/Planner.en.txt: New file.

	* doc/src/cms/Stylesheets.en.txt: New file.

	* doc/src/cms/Themes.en.txt: New file.

	* doc/src/cms/Titles.cs.txt: New file.

	* doc/src/cms/Titles.en.txt: New file.

	* doc/src/cms/_index.txt: New file.

	* doc/src/cms/cms-intro.en.txt: New file.

	* doc/src/cms/cms.en.txt: New file.

	* doc/src/admin/_index.txt: New file.

	* doc/src/admin/apache.en.txt: New file.

	* doc/src/admin/config.py: New file.

	* doc/src/admin/install.en.txt: New file.

	* INSTALL: Updated.

	* doc/src/_index.txt: New sections added.

	* doc/src/index.en.txt: Updated.

	* doc/src/intro.en.txt: File removed.  Contents moved to CMS section.

2007-08-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py: Modules `CookieAuthentication' and
	`Session' from `wiking.api' moved here.

	* lib/wiking/db.py (RssModule.action_rss): Configuration usage fixed.

	* lib/wiking/api.py: Some documentation added, some updated.
	Implementing classes moved away.

	* lib/wiking/__init__.py: Don't update module's private variables.
	Remove pytis config module from globals after it's use.

	* doc/src/devel/devel.en.txt: More documentation added.

	* doc/src/devel/api.py: Generate lists of interface methods and
	their documentation, as well as module's global docstring.

	* TODO: Updated.

2007-08-07  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/devel/devel.en.txt: New file.

	* doc/src/devel/api.py: New file.

	* doc/src/intro.en.txt: Added notes about the Wiking development
	platform and links to developer's documentation.

	* doc/src/_index.txt: `devel' section added.

	* sql/wiking.sql (config): `login_panel' -> `show_login_panel'.

	* translations/wiking-cms.cs.po: All translations filled.

	* lib/wiking/cms.py (Config): Use description and documentation of
	the configuration options within field specifications.

	* lib/wiking/configuration.py: Documentation for most options
	written.  `login_panel' -> `show_login_panel'.

	* lib/wiking/export.py: `cfg.login_panel' -> `cfg.show_login_panel'.

	* lib/wiking/api.py: `cfg.login_panel' -> `cfg.show_login_panel'.
	(Panels): Documentation added.
	

2007-08-03  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/News.en.txt: Minor improvement.

	* doc/src/admin/Modules.cs.txt: File removed.

	* doc/src/admin/Modules.en.txt: File removed.

2007-08-02  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Updated

	* lib/wiking/configuration.py: All configuration options defined here.

	* lib/wiking/request.py: Handle exceptions when loading mod_python.

	* lib/wiking/util.py (Theme): New class.
	(WikingNode.State): New class.
	(import_modules): Method removed.
	(get_module): The algorithm changed to allow `wikingmodules'
	override Wiking CMS modules.

	* lib/wiking/__init__.py: Import the new modules and update
	globals of all modules.

	* lib/wiking/module.py: Module removed.

	* lib/wiking/handler.py: Use global configuration and initialize node `state'.

	* lib/wiking/export.py: Use global configuration and node `state'.

	* lib/wiking/cms.py: New file - all CMS related code moved here.
	
	* lib/wiking/modules.py: All generic module definitions except for
	database related modules moved here.

	* lib/wiking/db.py: New file - all pytis database related module
	definitions moved here.

	* translations/wiking.cs.po: CMS translations moved to a separate file. 

	* translations/wiking.es.po: CMS translations moved to a separate file. 

	* translations/wiking.pl.po: CMS translations moved to a separate file. 

	* translations/wiking-cms.pl.po: New file.

	* translations/wiking-cms.es.po: New file.

	* translations/wiking-cms.cs.po: New file.

	* translations/Makefile: Generate also translations for the new
	domain `wiking-cms'.

2007-08-01  Tomas Cerha  <cerha@brailcom.org>

	* sql/wiking.sql: New theme color.

2007-07-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py: Authentication documentation written.
	Make password checking extensible.

	* doc/src/admin/admin.en.txt: Updated.

	* lib/wiking/configuration.py: New option `translation_paths'.

	* lib/wiking/util.py: Use it.
	(User) Don't care about password.

2007-07-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (PytisModule._action_menu): Only use Wiking
	actions.

	* lib/wiking/install.py: Minor improvement.

	* lib/wiking/request.py: Added support for authentication modularization.

	* lib/wiking/modules.py: Added support for authentication
	modularization.  Added classes implementing basic system modules
	independent of CMS modules.

	* lib/wiking/handler.py: Added support for authentication modularization.

	* lib/wiking/util.py (User): New class.
	(Roles.check): Expect a `User' instance as argument.

	* lib/wiking/export.py: Expect a `User' instance.

2007-06-29  Tomas Cerha  <cerha@brailcom.org>

	* sql/wiking.sql: Table `modules' removed.  Refer to modules by
	name in other relations (not by mod_id).

	* sql/init.sql: Don't initialize the table `modules'.

	* resources/css/default.css: Minor improvement.

	* lib/wiking/modules.py: Recognize installed modules
	automatically.  
	(Modules): Module removed.

	* defs/application.py: Use `WikingFileResolver'.

	* config.py: Don't set Pytis option `db_encoding'.

	* lib/wiking/__init__.py: Don't set Pytis option `db_encoding'.

2007-06-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py: Allow resolver redefinition in configuration.

	* lib/wiking/module.py: Make specification creation easily overridable.

	* lib/wiking/modules.py: Updated.  Make use of the new
	`lcg.SelfTranslatableText' class.

	* lib/wiking/util.py: Define a custom 'Specification' class.
	Added support for file-based resolvers.

	* resources/css/default.css: Main menu id changed.

	* lib/wiking/export.py: Avoid duplicit anchor name.  Compute the
	default value of `webmaster_address' id None.

2007-06-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py: Unecessary Apache site dispatching
	cleaned up.
	(Handler._module): Allow passing additional module constructor arguments.

2007-06-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/util.py: Set the correct title for the current node.

	* translations/wiking.cs.po: Updated.

	* lib/wiking/modules.py: Minor improvements.

	* lib/wiking/module.py: Don't reload the record from the database
	within `_update()' to allow overriding it correctly.

	* doc/src/user/accessibility.en.txt: Updated.

	* doc/src/user/navigation.cs.txt: Updated.

	* doc/src/user/navigation.en.txt: Updated.

	* resources/css/default.css: Hide breadcrumbs by default.

	* lib/wiking/export.py: Added breadcrumb navigation.

2007-06-07  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* lib/wiking/handler.py: Don't care about the panel styles.

	* lib/wiking/export.py: Accessibility improvements.

	* resources/css/panels.css: File removed.

	* resources/css/default.css: Improved.  Panel styles merged here.

2007-06-05  Tomas Cerha  <cerha@brailcom.org>

	* sql/wiking.sql: Page insert rule fixed.

	* lib/wiking/__init__.py: Version number increased.

	* lib/wiking/util.py: Site map support added.

	* lib/wiking/modules.py (Mapping): View as a `site map'.
	(Modules.Spec._ModNameType._check_constraints): Pass all keyword
	arguments to the parent method.

	* lib/wiking/module.py: RSS fixed.

2007-06-01  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* sql/init.sql: Updated.

	* lib/wiking/modules.py: Improved system module recognition.

	* lib/wiking/module.py: Fixed incompatibility with latest Pytis version.

	* lib/wiking/export.py: Local menu link added.

2007-05-24  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Updated.

	* lib/wiking/util.py: Added support for hierarchical navigation.
	Updated for the new LCG interface.

	* translations/wiking.cs.po: Updated.

	* sql/wiking.sql: Added support for hierarchical page structure.

	* lib/wiking/modules.py: Added support for hierarchical navigation
	in WMI.  Use LCG node structure directly for menus.
	(Mapping): Added support for definition of page hierarchy.

	* lib/wiking/module.py: Added support for hierarchical module
	listings.

	* lib/wiking/handler.py: Removed special handling of documentation
	and WMI requests thanks to better modularization.

	* lib/wiking/export.py: Added basic support for hierarchical
	navigation.

2007-05-23  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search._result_page): Set language for
	the document.

2007-05-21  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search._search_form): Return the document
	in the right language.

2007-05-18  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search._transform_input): Be more careful
	about content of the input.

2007-05-18  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/handler.py (SiteHandler.__init__): Get Exporter from
	the Config module.

	* lib/wiking/modules.py (Config.Configuration): New attribute
	`exporter'.
	
2007-05-17  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search._transform_input): Use AND search
	rather then OR search.

2007-05-17  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search): Print a message if nothing is
	found.

2007-05-17  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/handler.py: Use module qualification with the
	Exporter class.

2007-05-15  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/modules.py (Search): New module.

2007-05-03  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/util.py (send_mail): Put timezone into date.

2007-05-02  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/module.py (RssModule.action_rss): If uri is not
	given, make it an empty string, not None.

2007-05-01  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/module.py (RssModule._descr_provider): New method.

2007-04-18  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py: Dispose module instances after reloading
	a module.

	* lib/wiking/module.py: Module creation logging moved to the base
	`Module' class.

2007-04-17  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/export.py: Don't skip to panels when they are hidden.

	* lib/wiking/modules.py: Cosmetic improvements (source code wrap
	limit extended to 100 columns).

2007-04-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/export.py (Exporter.ctrl): Obey the new config option
	`allow_login_ctrl'.

	* lib/wiking/modules.py: Fixed a problem with unknown registration
	URI in login panel.  Allow suppression of login ctrl through
	configuration.

2007-04-12  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* lib/wiking/util.py (LoginCtrl): New class.

	* lib/wiking/modules.py (Panels.panels): Add a login panel
	automatically if it is configured.
	(Users): Don't display user listing after registration.  Display
	further information instead.
	(Mapping.resolve): Allow new user registration even if the `Users'
	module is private.

	* lib/wiking/handler.py: Removed unecessary `config' settings.

	* lib/wiking/export.py: Don't create the login panel here, just
	expect it in `panels'.

2007-04-11  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/Mapping.en.txt: Updated.
	
	* doc/src/admin/Mapping.cs.txt: Updated.

	* sql/wiking.sql: Added support for private items.

	* resources/css/default.css: Yet another MSIE hack. 

	* lib/wiking/modules.py: Accept also custom modules
	defined in `wikingmodules'.
	(Mapping): Added support for private items.

	* lib/wiking/handler.py: Use the changed `Mapping'
	interface.

2007-04-04  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* lib/wiking/export.py: Show login controls in wiking bar when
	wiking panel is off.

	* lib/wiking/handler.py: Handle exceptions in exception processing.
	Handle int as a valid handler return value.

	* lib/wiking/request.py: Don't prefill the login name to allow
	browser based login/password management.  Session cookie
	expiration further extended.  Added support for HTTP redirection.
	Unset session cookie after logout.

	* sql/wiking.sql: Removed oid columns.  Table users moved to the
	beginning of the file.  Expect `image_id' in the inserted row.
	Fixed attachment insert rule.  New config option
	`force_https_login'.
	
	* lib/wiking/__init__.py: Version number increased to 0.4.2.

	* lib/wiking/modules.py (Images): Compute sequence fields.
	(Users): Don't set current user as the record owner.
	(Attachments): Use `Request' support for HTTP redirection.
	(Config): New option `force_https_login'.
	(Attachments): Added DB exception matcher.

	* lib/wiking/module.py (PytisModule._insert): Set new row only
	when it is not None.  Allow a module to disable automatic record
	owner setting.

2007-04-03  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/Attachments.cs.txt: New file.

	* doc/src/admin/Attachments.en.txt: New file.

	* doc/src/admin/Pages.cs.txt: New section about attachments.

	* doc/src/admin/Pages.en.txt: New section about attachments.

	* lib/wiking/handler.py (SiteHandler.handle): Never call
	`req.user()' outside the exception handling block.

	* lib/wiking/export.py: Don't link to WMI module.

	* sql/wiking.sql (themes) New colors.
	(news, planner): Added author references.

	* resources/css/default.css: Updated.

	* lib/wiking/request.py (Request.result): Encode the returned data
	only if it is a unicode instance.
	(WikingRequest._perform_login): Extend session cookie expiration time.

	* lib/wiking/util.py: Improved custom views and thier specification.

	* lib/wiking/modules.py (Attachments): List fields accepted out of
	layout.
	(Themes.COLORS): New symbolic colors.
	(News, Planner): Added author information.  Allow insertion by
	CONTRIBUTOR.  Updated for new `CustomViewSpec'.
	(WikingManagementInterface): Switch to WMI mode only after
	successful authorization.

	* lib/wiking/module.py: Supply record owner on insertion.
	Validate only layout fields and fields explicitly listed.  Added
	support for codebook field links.
	(RssModule): Use real author column.
	(PytisModule._validate): Use only the last part of an uploaded
	file path (from MS windows).

2007-04-02  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/Mapping.cs.txt: Updated.

	* doc/src/admin/Mapping.en.txt: Updated.

	* doc/src/admin/Panels.cs.txt: Updated.

	* doc/src/admin/Panels.en.txt: Updated.

	* lib/wiking/export.py: Display item descriptions.

	* translations/wiking.cs.po: Updated.

	* resources/css/default.css: Minor improvements.

	* lib/wiking/util.py (Roles.check): Allow privileg checking
	without raising an error.
	(MenuItem): Added support for item descriptions.

	* lib/wiking/modules.py: Added short module descriptions.  Use
	roles and custom actions in the modules `Users' and `Rights'.
	Added field descriptions for `Panels'.  Supply WMI menu item
	descriptions.

	* lib/wiking/module.py: Implemented the `OWNER' role authorization
	check.  Show only authorized actions in the action menu.  Show
	actions also outside WMI.  Allow easier action menu redefinition.

2007-03-30  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* sql/wiking.sql: Removed rowlocks and oids.  Fixed rules for
	`attachments'.  Added `published' into `pages'.

	* lib/wiking/modules.py: Allow publishing/unpublishing pages
	directly.  Added action descriptions.  Support pytis returning the
	inserted row in the Attachments module.  Redirect after attachment
	operations.

	* lib/wiking/module.py: Added action descriptions.  Implemented
	sequence value generation before insert to support pytis returning
	the inserted row.

	* lib/wiking/util.py (ActionMenu): Show action description as link
	title.
	(Roles.check): Don't raise the error here, leave it up to
	`Request.user()'.
	

	* lib/wiking/request.py (Request.set_header): New method.
	(WikingRequest.user): New argument `raise_error'.  Announce
	session timeout.

2007-03-29  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: Updated.

	* lib/wiking/modules.py: Added many field descriptions.
	(Mapping.menu): Expect the request as first argument.

	* lib/wiking/handler.py (SiteHandler.handle): Login before mapping
	resolution.  Pass request to Mapping.menu().

	* lib/wiking/util.py (Forbidden): New HTTP errror type.

2007-03-27  Milan Zamazal  <pdm@brailcom.org>

	* lib/wiking/util.py (send_mail): Don't write the HTML part if
	it is empty.

2007-03-26  Tomas Cerha  <cerha@brailcom.org>

	* translations/Makefile: Don't assume LCG path, use it as a Python
	library.

	* lib/wiking/modules.py (Config.Configuration): New option
	`allow_wmi_link'.
	(_modtitle): Use `get_module' to get the module class.

	* lib/wiking/export.py: Don't produce WMI link unless
	`config.allow_wmi_link' is True.

2007-03-17  Tomas Cerha  <cerha@brailcom.org>

	* sql/init.sql: Supply all mandatory fields for the default admin.
	Assign `mod_id' into the default mapping by module name.
	
	* translations/wiking.cs.po: Updated.

	* sql/wiking.sql: New theme column for `help'.  New config option
	`allow_registration'.

	* resources/css/default.css: Updated.

	* lib/wiking/request.py: Perform authentication on demand.

	* lib/wiking/util.py (Roles.check): Check authentication only when
	it is really needed.  Minor improvements.

	* lib/wiking/modules.py: Use the new RegexString data type for
	certain fields.  Allow authentication on demand.  Many minor
	improvements in field specifications.  Added a few field
	descriptions.  Disable table layout for the `Users' module.
	Use the new support for `FieldSet'.

	* lib/wiking/module.py: Added support for disabling table layout
	in forms on a per-module basis.  Other minor improvement.

	* lib/wiking/handler.py: Enforce authentication within the
	RequestError handling block.

	* lib/wiking/export.py: Display registration link in the login panel.

2007-03-16  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Added style for `not-null' signs.

	* lib/wiking/handler.py: Catch RequestErrors also for Mapping lookup.

	* lib/wiking/module.py (PytisModule._link_provider): Return 'None'
	if the module identifier is not known.

	* sql/init.sql: Added the new modules into the list of available
	modules.

	* lib/wiking/modules.py: Use the new role assignment mechanism and
	define some basic privilegs for all actions.

	* lib/wiking/util.py: Avoid passing the `command' in login dialog.
	(Roles): New class for static user role definition.
	(get_module): Try importing `wikingmodules' first and
	`wiking.modules' only if `wikingmodules' were not found.

	* lib/wiking/configuration.py: Search also for the module
	`wikingconfig' as the default configuration file.

2007-03-15  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po: New translations.

	* sql/init.sql: Create initial admin account.

	* lib/wiking/handler.py: Updated request error handling.

	* lib/wiking/install.py: Announce the default admin username and
	password after successful install.

	* lib/wiking/modules.py: New module for rights management.  New
	module for static user roles definition.  Require admin privileges
	in WMI.

	* lib/wiking/util.py: New and improved exception classes for
	request errors.

	* lib/wiking/module.py: Added support for password validation.
	Fixed boolean value validation.

	* lib/wiking/request.py: Fixed multivalue parameter
	initialization.  Use the new exception classes for authentication
	errors.

	* lib/wiking/export.py: Login panel fix.

2007-03-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py: Reflect the base class refactoring.
	Added documentation.
	(Documentation, WikingManagementInterface): New modules.
	(Mapping): Added static mapping for `_wmi' and `_doc'.

	* lib/wiking/module.py: Refactored: Define only the most basic
	interface in the base class, move all Pytis related functionality
	to `PytisModule', isolate action dispatching to `ActionHandler'.

	* lib/wiking/export.py: Respect the node config option change.

	* lib/wiking/handler.py: Pass module constructor arguments
	according to its type.  Don't handle documentation or WMI requests
	here, rely on their (new) modules.  Added more documentation.
	Cleaned up.

2007-03-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/util.py: Support LCG resources and use don't
	implement custom stylesheet passing.

	* lib/wiking/modules.py: Generate page attachments and stylesheets
	as the corresponding `Resource' instances.

	* lib/wiking/module.py: Pass keyword arguments to `Document'
	constructor.  Allow link generation depending on the target
	component which uses the link.
	
	* lib/wiking/handler.py: Expect `lcg.Stylesheet' instances from
	`Stylesheets.stylesheets()'.  Use `Exporter.export()' instead of
	`Exporter.page()'.

	* lib/wiking/export.py: Rely on superclass to include stylesheet
	links in the header.

2007-03-08  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/util.py: Use LCG's generator instead of the `_html'
	module.

	* lib/wiking/modules.py: Don't use LCG's `_html' module.

	* lib/wiking/module.py: Don't use LCG's `_html' module.

	* lib/wiking/handler.py: Expect LCG content from `HttpError.msg()'
	not HTML directly.

	* lib/wiking/export.py: Use LCG's generator instead of the `_html'
	module.

2007-03-07  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/export.py: Use named substitutions in translatable
	texts instead of positional.

	* sql/wiking.sql: Added tables, views and rules supporting the
	`Attachments' module.

	* lib/wiking/util.py: Action menu constructor arguments changed.
	Use named substitutions in translatable texts instead of
	positional.

	* lib/wiking/modules.py: Use the `action_' prefix for all action
	methods.  Minor fixes.  List attachments at the bottom of a page.
	Resolve attachments by page identifier and filename.

	* lib/wiking/module.py: Fixed DB exception matching.  New URI
	scheme in WMI.  Use the `action_' prefix for all action methods.
	Added support for "related" modules -- records of another module
	depending on the current record of the current module.  Added
	support for module redirection.  Use new `lcg' content
	constructors.

	* lib/wiking/handler.py: Use the `action_' prefix for all action
	methods.  Use `req.path'.  Added support for module redirection.

2007-03-05  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py: Don't perform identifier/module name
	caching here -- leave it up to the `Mapping' module.

	* lib/wiking/modules.py: Perform caching of module identifier/name
	assignments (for request resolution).  New module `Attachments'.

	* lib/wiking/export.py: Removed duplicit anchor name.

2007-03-04  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/util.py: Many docstrings added.

2007-03-02  Tomas Cerha  <cerha@brailcom.org>

	* Makefile: Added `cvs-install' option.

	* lib/wiking/install.py: Use psycopg directly.

	* lib/wiking/util.py: Removed support for `edit_label'...

	* lib/wiking/request.py: Minor fix.

	* lib/wiking/module.py: Generic support for saving binary data in
	files.  Major rewrite of URI construction.  Other minor
	improvements.
	(Module): 

	* lib/wiking/handler.py: Minor enhancements.

	* lib/wiking/configuration.py: New option `storage'.

	* lib/wiking/modules.py: Comment improved.

2007-02-26  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/handler.py: Current module and record resolution
	simplified and unified.

	* lib/wiking/module.py: Database modification methods separated
	from their action handlers.  Current record abstraction
	refactored.

	* lib/wiking/modules.py: Respect the above changes.

2007-02-23  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Updated.

	* sql/wiking.sql: Added table for storing image information.

	* lib/wiking/util.py: Added classes supporting file upload
	abstraction and custom view support.

	* lib/wiking/request.py: Added support for file upload handling.

	* lib/wiking/modules.py: Universal mixin classes moved to
	`module.py'.  Use the new custom view support.  New module `Images'.

	* lib/wiking/module.py: Custom view support refactored.  RSS and
	panelization support separated to derived classes.  Validation
	extended to support binary data types.

	* lib/wiking/install.py: Updated for `dbapi' pytis interface.

2007-02-02  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (WikingModule._validate): Treat
	`view.check()' result as a sequence.

2007-01-19  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (WikingModule._validate)
	(WikingModule._get_row_by_key): Use only the last value of the
	parameter, it it is a tuple.

	* lib/wiking/request.py (Request._init_params.init_value): New
	function.
	(Request._init_params): Use it.

2007-01-18  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css (Module): Added MSIE workaround for
	invisible floated images.

2007-01-16  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (WikingModule.rss): Translate `title' and
	`descr' fields before escaping.

2007-01-15  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/export.py (Exporter.ctrl): Only use `config.module'
	if it is available.

2007-01-14  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.*.po: Updated.

	* lib/wiking/install.py: Add a button for initializing the
	database after its creation.

	* sql/init.sql: Modified according to the new DB schema.

	* doc/src/admin/Pages.cs.txt: New file.

	* doc/src/admin/Pages.en.txt: New file.

	* lib/wiking/export.py (Exporter._wiking_bar): Let the WMI link
	point directly to the current module.

	* lib/wiking/handler.py (SiteHandler.handle): Add the current
	module to node config.

	* lib/wiking/module.py (WikingModule.name): New class method.
	(WikingModule.Object.__str__, WikingModule.spec) 
	(WikingModule.__init__, WikingModule._real_title) 
	(WikingModule._link_provider, WikingModule.list): Use it.

	* doc/src/admin/Content.en.txt: File removed.

	* doc/src/admin/Content.cs.txt: File removed.

2007-01-12  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (Themes.COLORS): New colors for inactive
	buttons.
	(Content): Class significantly redesigned and renamed to `Pages'.
	(Pages.view): New keyword argument `preview'.
	(Pages.preview): New method.
	(Pages._ACTIONS): New action `preview'.

	* defs/application.py: `Content' -> `Pages'.

	* lib/wiking/module.py: 'pytis.web' -> `pw'.
	(WikingModule._DEFAULT_ACTIONS): Split to `_DEFAULT_ACTIONS_FIRST'
	and `_DEFAULT_ACTIONS_LAST'
	(WikingModule._INSERT_MSG, WikingModule._UPDATE_MSG)
	(WikingModule._DELETE_MSG, WikingModule._LIST_ACTIONS): New
	constants.
	(WikingModule.Object.update): New method.
	(WikingModule.spec): Avoid repeating actions.  Also process
	actions of the current class.
	(WikingModule._validate): Skip key columns only if not `new'.
	(WikingModule._document): Always supply all languages as variants
	in WMI.
	(WikingModule._actions): Return `ActionMenu' instance.
	(WikingModule.list, WikingModule.show, WikingModule.remove): Use
	`self._actions' in its new meaning.
	(WikingModule.insert): Use `self._INSERT_MSG'.
	(WikingModule.update): Use `self._UPDATE_MSG'.
	(WikingModule.delete): Use `self._DELETE_MSG'.
	(WikingModule.update): Fix.

	* lib/wiking/handler.py (SiteHandler.handle): 'Content' -> `Pages'.

	* lib/wiking/__init__.py (__version__): Import `pytis.web' as `pw'.

	* lib/wiking/util.py (ActionMenu.__init__): Expect a
	`PresentedRow' instance as the `row' argument.
	(ActionMenu._export_item): Set the `inactive' class for inactive
	items.

	* sql/wiking.sql: Table `_content' and view `_content' replaced by
	a redesigned table _`pages' and view `pages' and corresponding
	rules.  New columns for inactive button colors in the table
	`themes'.

	* resources/css/default.css: Added styles for inactive action buttons.

2007-01-09  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (WikingModule._RSS_DESCR_COLUMN): New
	constant.
	(WikingModule.rss): Don't overwrite the base uri in the cycle.
	Supply values for additional RSS tags.

	* lib/wiking/modules.py (News.Spec.fields): Removed field `rss_title'.
	(News.Spec._rss_title): Method removed.
	(News._RSS_TITLE_COLUMN): Set to `title'
	(News._RSS_DATE_COLUMN): New constant.
	(Planner._RSS_DATE_COLUMN, Planner._RSS_TITLE_COLUMN): New constants.

	* lib/wiking/util.py (rss): New keyword arguments `lang' and
	`webmaster'.  Additional values `author' and `date' in items.
	Support also `generator', `ttl' and `guid' elements.

2007-01-08  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/Planner.en.txt: LCG documentation link fixed.

	* doc/src/admin/Planner.cs.txt: LCG documentation link fixed.

	* doc/src/admin/News.en.txt: LCG documentation link fixed.

	* doc/src/admin/News.cs.txt: LCG documentation link fixed.

	* doc/src/admin/Content.en.txt: LCG documentation link fixed.

	* doc/src/admin/Content.cs.txt: LCG documentation link fixed.

2007-01-02  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.pl.po: New translations.

	* doc/src/user/accessibility.pl.txt: New file.

	* doc/src/user/navigation.pl.txt: New file.

	* doc/src/user/rss.pl.txt: New file.

2006-12-23  Tomas Cerha  <cerha@brailcom.org>

	* Makefile (install): Don't depend on `translations'.

2006-12-22  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (News.Spec.fields): Use the `DateTime'
	type for `timestamp'.  Make `date' a virtual column with a
	computer.
	(News.Spec._rss_title): Export both values.
	(News.Spec._date): New method.
	(Planner.Spec.fields): Use the `Date' type for `start_date' and
	`end_date'.
	(Planner.Spec._date): Export dates with a weekday.
	(Users.Spec.fields): Use the `DateTime' type for the field
	`since'.

	* lib/wiking/module.py (WikingModule._datetime_formats): New
	method.
	(WikingModule._validate): Take `req' argument instead of just
	value dict.  Choose the correct date/time formats for validation
	according to current language.
	(WikingModule.insert, WikingModule.update): Pass `req' to
	`self._validate'.

	* lib/wiking/util.py (DateTime, Date): New classes.
	(translator): New function.

	* lib/wiking/handler.py (_translator): Method removed.
	(SiteHandler.handle): Use the `translator()' function instead of
	the method.

2006-12-21  Tomas Cerha  <cerha@brailcom.org>

	* doc/src/admin/Planner.en.txt: New file.

	* doc/src/admin/Planner.cs.txt: New file.

	* lib/wiking/modules.py (Modules.Spec.fields): New field `ord'.
	(Modules.Spec): Added `ord' to layout, columns and sorting.
	(Modules.menu): Sort menu by `ord'.
	(Content._variants): Return only published variants.
	(News.ListView._export_row): Export `content' only when not null.
	(Planner.Spec.fields): New fields `start_date' and `end_date'.
	`date' is just a virtual field computed from both dates.
	(Planner.Spec.sorting): Sort by `start_date'.
	(Planner.Spec._check_date, Planner.Spec._date) 
	(Planner.Spec.check): New methods.
	(Planner._condition): Use both dated in the condition.

	* lib/wiking/module.py (WikingModule._validate): Added support for
	the `check' constraint.

	* translations/wiking.cs.po: Updated.

	* lib/wiking/export.py (Exporter._login_ctrl): "Anonymous" ->
	"anonymous".

	* sql/wiking.sql (modules): New column `ord'.
	(planner): Column `date' renamed to `start_date'.  New column
	`end_date'.  Allow null values for `content'.

	* sql/init.sql: Insert modules with order numbers.

2006-12-20  Tomas Cerha  <cerha@brailcom.org>

	* sql/wiking.sql (planner): New table.

	* lib/wiking/util.py (Data.get_rows): New keyword argument
	`condition'.

	* lib/wiking/modules.py (Modules.Spec.columns): Use `name', not
	`title' in layout.
	(Content.Spec.fields): Define as a method.
	(News.Spec.fields): New field `rss_title'.
	(News.ListView._export_row): Don't use `news-' prefix for anchors.
	Use the first field as a key column.
	(News._link_provider): Don't use `news-' prefix for anchors.  Use
	`self._referer' as key column.
	(Planner): New class.

	* lib/wiking/module.py (WikingModule._spec_cache): New attribute.
	(WikingModule.spec): Use common cache
	`WikingModule._cpec_cache', not a class attribute.
	(WikingModule._default_prefill): New method.
	(WikingModule.add): Use it.
	(WikingModule._condition): New method.
	(WikingModule._rows): New method.
	(WikingModule._list): Use `self._rows'.  New argument `limit'.
	(WikingModule.panelize): Use `self._rows'.  Handle empty list.
	(WikingModule.rss): Raise `NotFound' when `self._RSS_TITLE_COLUMN'
	is not defined.  Use `PresentedRow' to support virtual columns.
	(WikingModule.list): Print RSS info when `self._RSS_TITLE_COLUMN'
	is defined, not `self._RSS_DESCR_COLUMN'.

2006-12-19  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (Config.Spec.fields): New field `login_panel'.
	(News.Spec.fields): Set default timestamp in GMT.
	(Users.Spec.fields): Set type of `login' to Identifier.  New
	columns for session handling.
	(Users._user, Users._update, Users.user, Users.check_session) 
	(Users.save_session, Users.close_session): New methods.

	* lib/wiking/request.py (Request.get_cookie): Renamed to `cookie'.
	(WikingRequest._LOGIN_COOKIE, WikingRequest._SESSION_COOKIE)
	(WikingRequest._MAX_SESSION_KEY): New constants.
	(WikingRequest._init_params): `get_cookie()' -> `cookie'.  Process
	login form data.
	(WikingRequest.prefered_language): Docstring added.
	(WikingRequest.login_name): New method.
	(WikingRequest.user): New method.
	(WikingRequest.prefered_language): New method.
	(WikingRequest.check_auth): New method.

	* lib/wiking/util.py (Action.name): Renamed to `title()'.
	(Unauthorized): New class.
	(PanelItem.__init__): Take just `fields' argument.
	(PanelItem.export): Completely rewritten.
	(PanelItem._export_field): Method removed.
	(LoginDialog): New class.

	* lib/wiking/module.py (WikingModule.panelize): Use PresentedRow
	to support computed columns.  Pass simplified arguments to
	PanelItem constructor.
	

	* doc/src/user/navigation.en.txt: Updated.

	* doc/src/user/navigation.cs.txt: Updated.

	* lib/wiking/export.py (Exporter._page): New method.
	(Exporter._panels): Put both panel controls above the panels.  Add
	login panel if enabled.
	(Exporter._content): Cosmetic changes.
	(Exporter._wiking_bar): Cosmetic changes.

	* lib/wiking/handler.py (SiteHandler._translator): New method.
	(SiteHandler.handle): Handle also `Unauthorized' errors.  Use
	`self._translator'.
	(SiteHandler.handle): Set `config.user' for exporter.

	* resources/css/default.css:  Added styles for login form.

	* resources/css/panels.css: Added styles for login panel.

	* sql/wiking.sql (users): New columns for session handling and
	access rights.
	(config): New column `login_panel'.
	
2006-12-14  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py (Users.Spec.fields): Transformed to a
	method.

	* Makefile (doc): New target to generate HTML documentation.

	* README: Refer to the documentation.

	* doc/src/admin/Stylesheets.en.txt: New file.

	* doc/src/admin/admin.en.txt: New file.

	* doc/src/user/user.en.txt: New file.

	* doc/src/user/user.cs.txt: New file.

	* doc/src/user/_index.txt: New file.

	* doc/src/intro.en.txt: New file.

	* doc/src/index.en.txt: New file.

	* doc/src/fdl.en.txt: New file.

	* doc/src/_index.txt: New file.

2006-12-13  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/request.py (Request.__init__): Call
	`self._init_uri()' to initialize the `uri' attribute.
	(Request._init_uri): New metohd.
	(WikingRequest._init_params): Use argument `setlang' for explicit
	language, not `lang' and `keep_language'.
	(WikingRequest._init_uri): New method.  Perform RSS redirection
	here transparently.

	* lib/wiking/module.py (WikingModule.rss): Don't care about the
	uri redirection here.  Use argument `setlang' for explicit
	language.

	* lib/wiking/handler.py (SiteHandler._action): Don't perform the
	RSS redirect here.

	* lib/wiking/export.py (Exporter._node_uri): Use argument
	`setlang' for explicit language, not `lang' and `keep_language'.

	* lib/wiking/util.py (Document.__init__): New keyword argument
	`sec_lang'.
	(Document.mknode): Pass `secondary_language' to the node
	constructor.
	(NotAcceptable.msg): Use argument `setlang' for explicit language,
	not `lang' and `keep_language'.

2006-12-12  Tomas Cerha  <cerha@brailcom.org>

	* doc/modules/Languages.cs.txt (Module): Minor improvements.
	
	* doc/modules/Languages.en.txt (Module): Minor improvements.

2006-12-11  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.cs.po (Module): Updated.

	* translations/wiking.pl.po (Module): Updated.

	* translations/wiking.es.po (Module): Updated.

	* resources/css/default.css: Don't suppress underlining TOC links.

	* lib/wiking/modules.py (Mapping._link_provider): New argument
	`args'.  WMI uri changed to `_wmi'.
	(Config.theme): Removed commented theme caching.
	(News._link_provider): New argument `args'.

	* lib/wiking/module.py (_on_update): Method removed.
	(WikingModule._link_provider): New argument `args'.  Encode args
	into the final uri.  Use `_html.uri' for generating the uri.
	(WikingModule._list): New argument `lang'.  Use `lang' if given.
	(WikingModule.list): Doc uri changed to `_doc'.  Add link to RSS
	documentation.
	(WikingModule.update): Don't call `self._on_update()'.

	* lib/wiking/install.py (maybe_install): WMI uri changed to `_wmi'.

	* lib/wiking/handler.py (SiteHandler._resolve): Recognize the
	language suffix in the rss uri.
	(SiteHandler._doc): Search all subdirectories.  Don't create TOC
	automatically.
	(SiteHandler.handle): WMI uri changed to `_wmi'.  Doc uri changed
	to `_doc'.  Set the `doc' attribute of node config.  Support
	displaying documentation inline.

	* lib/wiking/export.py (Exporter._menu): Added accesskeys.
	(Exporter._content): Cosmetic change.
	(Exporter.ctrl): Changed WMI uri.  Also recognize the doc state.
	(Exporter._footer): Added `Accessibility Statement' link.

	* doc/modules/Mapping.cs.txt: Minor improvements.

	* doc/modules/Mapping.en.txt: Minor improvements.

	* doc/user/rss.cs.txt: New file.
	
	* doc/user/rss.en.txt: New file.

2006-12-10  Tomas Cerha  <cerha@brailcom.org>

	* doc/user/accessibility.cs.txt: New file.

	* doc/user/accessibility.en.txt: New file.

2006-12-05  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/modules.py: Define aliases for useful constants here,
	don't import them from pytis.extensions.
	(Themes.Spec.layout): New method.

	* lib/wiking/__init__.py (__version__): Don't import pytis.extensions.

	* lib/wiking/util.py (cmp_versions): New function.

	* Makefile: New file.

	* README: New file.

2006-12-04  Tomas Cerha  <cerha@brailcom.org>

	* doc/modules/Languages.cs.txt: Minor improvements.
	
	* doc/modules/Languages.en.txt: Minor improvements.

	* lib/wiking/modules.py
	(Modules.Spec._ModNameType._VALIDATION_MESSAGES): Konstanta zruena.
	(Modules.Spec._ModNameType._VM_UNKNOWN_MODULE_MSG): Nov konstanta.
	(Mapping.Spec): Nastav maximln dlku identifiktoru.

2006-12-01  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/request.py (Request.abs_uri): Guess protocol based on
	port number.

	* lib/wiking/export.py (Exporter._panels): Panel control labels
	changed.  Represent panel headings as divs, not h1 tags.
	(Exporter._panels): Improved handling of horizontal rules.

	* lib/wiking/configuration.py: 
	(Configuration._Option_https_ports): New option.

2006-11-30  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking-help.cs.po: File removed.

	* resources/css/default.css: Added styles for panel controls.

	* lib/wiking/modules.py (Panelizable): Class removed.
	(Modules, Mapping, Config, Languages, Themes, Stylesheets, Users) 
	(Panels, Titles, Content, News): Specifications rewritten using
	a class derived from `pytis.presentation.Specification'.

	* lib/wiking/module.py (WikingModule._TITLE)
	(WikingModule._SINGULAR_TITLE, WikingModule._FIELDS)
	(WikingModule._LAYOUT, WikingModule._LAYOUT_COLUMNS)
	(WikingModule._TABLE, WikingModule._KEY, WikingModule._SORTING)
	(WikingModule._CB_SPEC, WikingModule._COLUMNS)
	(WikingModule._ACTIONS):Constants removed.
	(WikingModule._PANEL_DEFAULT_COUNT, WikingModule._PANEL_FIELDS):
	New constants.
	(WikingModule.Object.__init__): New argument `view'.
	(WikingModule.Object.__init__, WikingModule.Object.prow): New
	method.
	(WikingModule.View.__init__): New argument `resolver'.
	(WikingModule.ListView.__init__): New argument `resolver'.
	(WikingModule.spec): New method.
	(WikingModule.data_spec, WikingModule.view_spec)
	(WikingModule.binding_spec, WikingModule.cb_spec): Methods
	removed.
	(WikingModule.__init__): New argument `resolver'.  Use
	`self.spec()' to get the `Specification' instance.  Get
	specifications form this instance.  Don't translate sorting spec.
	(WikingModule._form): New method.
	(WikingModule._help): Method removed.
	(WikingModule._document): Use `self._view.singular()' instead of
	`self._view.layout().caption()'.
	(WikingModule._list): Soppose `distinct()' to return a sequence of
	`Value' instances.
	(WikingModule.resolve): Pass `self._view' to the Object
	constructor.
	(WikingModule.panelize): New method.
	(WikingModule.list): Include just a link to documentation, not hte
	help text itself.
	(WikingModule.list, WikingModule.show, WikingModule.add) 
	(WikingModule.edit, WikingModule.remove): Use `self._form()'
	instead of constructing the form directly.
	(WikingModule.insert):  Pass `self._view' to the Object
	constructor.

	* lib/wiking/handler.py (Handler._site_handler): Pass a resolver
	instance to `SiteHandler' constructor.
	(SiteHandler.__init__): New argument `resolver'.
	(SiteHandler._module): Pass a resolver instance to module
	constructor.
	(SiteHandler._stylesheets): Accept `req' and `panels' arguments.
	(SiteHandler._doc): Also support wiking documentation in wiking
	doc directory.
	(SiteHandler.handle): Heavilly rewritten.  Improved documentation
	handling.  Pass options to the exporter in the node config.  Don't
	use `TRANSLATION_PATH', build it here.

	* lib/wiking/__init__.py (TRANSLATION_PATH): Constant removed.
	Don't import `help'.

	* lib/wiking/export.py (Exporter._is_wmi_node): Method removed.
	(Exporter._top): Always use `config.site_title'.
	(Exporter._panels): Hide panels if `config.show_panels' is False.
	Show panel show/hide controls.
	(Exporter.ctrls): Use `config.wmi' instead of `self._is_wmi_node()'.

	* lib/wiking/help.py: Module removed. 

	* lib/wiking/request.py (WikingRequest._PANELS_COOKIE): New class.
	(WikingRequest._init_params): Initialize `self._show_panels'.
	(WikingRequest.show_panels): New method.
	(WikingRequest.__init__): Method removed.

	* lib/wiking/util.py (split_camel_case, camel_case_to_lower):
	Functions removed.
	(HttpError.name): Use `split_camel_case' from Pytis.
	(__init__, available): Methods removed.
	(NotAcceptable.msg): Use `self.args' instead of `self._available'.
	(Field): Class removed - be just an alias to
	`pytis.presentation.FieldSpec'
	(WikingResolver.get): Use specification classes instead of modules
	directly.
	(DirectData): Class removed.

	* doc/modules/Titles.en.txt: New file.
	
	* doc/modules/Titles.cs.txt: New file.

	* doc/modules/Panels.en.txt: New file.

	* doc/modules/Panels.cs.txt: New file.

	* doc/modules/News.en.txt: New file.

	* doc/modules/News.cs.txt: New file.

	* doc/modules/Modules.en.txt: New file.

	* doc/modules/Modules.cs.txt: New file.

	* doc/modules/Mapping.en.txt: New file.

	* doc/modules/Mapping.cs.txt: New file.

	* doc/modules/Languages.en.txt: New file.

	* doc/modules/Languages.cs.txt: New file.

	* doc/modules/Content.en.txt: New file.

	* doc/modules/Content.cs.txt: New file.

2006-11-21  Tomas Cerha  <cerha@brailcom.org>

	* sql/init.sql: Operator fixed.

	* sql/wiking.sql: Typo fixed.

2006-11-13  Tomas Cerha  <cerha@brailcom.org>

	* defs/application.py: Fixed copyright and author information.

	* lib/wiking/*.py: Fixed copyright and author information.

	* COPYING: New file.

	* translations/wiking.*.po: Updated.

	* lib/wiking/export.py (Exporter._menu): Don't hardcode the label
	to be hidden.  Just mark it as a label.
	(Module): Added basic accesskey support.

	* resources/css/default.css: Minor cleaning.

2006-11-11  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.pl.po: Updated.

	* translations/wiking.es.po: New file.

	* lib/wiking/util.py (DocModule): Class removed.

	* lib/wiking/modules.py (Config.theme): Don't cache themes.

	* lib/wiking/handler.py (SiteHandler._doc): New method.
	(SiteHandler._resolve): Don't handle doc here.
	(SiteHandler.handle): Handle documentation requests differently.

	* lib/wiking/export.py (Exporter._node_uri): New method.
	(Exporter._is_current): Respect just the top level id.
	(Exporter._top): Add three divs to support several layers of
	backgrounf images.

006-11-08  Tomas Cerha  <cerha@brailcom.org>

	* translations/wiking.pl.po: Updated.

	* translations/wiking.cs.po: Updated.

	* translations/wiking-help.cs.po: Updated.
	
	* lib/wiking/util.py (DocModule.view): Search all the available
	language variants of the document and perform language selection
	according to the request.

	* lib/wiking/handler.py (Handler.__call__): Pass just an error
	message to `Request.error()'.

	* lib/wiking/request.py (Request.error): Accept just one argument
	- the error message.  Escape it befor printing.

2006-11-06  Tomas Cerha  <cerha@brailcom.org>

	* lib/wiking/module.py (WikingModule._document)
	(WikingModule._list): Use the new method
	`Request.prefered_language()'.

	* lib/wiking/modules.py (Modules.ModNameType): New type which only
	allows valid Module names.
	(Modules._FIELDS): Use it for `name'.

	* lib/wiking/handler.py (Handler.__call__): Some more information
	about the request added into the e-mail message.

	* lib/wiking/request.py (Request.error): Don't print the
	traceback, just a short error message.
	(WikingRequest.prefered_languages): New method.

2006-11-04  Tomas Cerha  <cerha@brailcom.org>

	* resources/css/default.css: Syntax fixed.

	* translations/wiking.pl.po: New file

	* translations/wiking.cs.po: Updated.
